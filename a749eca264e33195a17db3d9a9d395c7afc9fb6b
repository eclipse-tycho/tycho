{
  "comments": [
    {
      "key": {
        "uuid": "feee42ec_398253b8",
        "filename": "tycho-bundles/org.eclipse.tycho.p2.resolver.impl/src/main/java/org/eclipse/tycho/p2/target/TargetDefinitionResolverService.java",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 171685
      },
      "writtenOn": "2020-12-21T14:19:34Z",
      "side": 1,
      "message": "I\u0027m not sure if we need the future approach here, if I understand right the API doc computeIfAbsent will block other threads already.",
      "revId": "a749eca264e33195a17db3d9a9d395c7afc9fb6b",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "11cdb20d_25a606f5",
        "filename": "tycho-bundles/org.eclipse.tycho.p2.resolver.impl/src/main/java/org/eclipse/tycho/p2/target/TargetDefinitionResolverService.java",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 101744
      },
      "writtenOn": "2020-12-21T14:22:36Z",
      "side": 1,
      "message": "The future is only used to wrap result|exception, not for blocking.",
      "parentUuid": "feee42ec_398253b8",
      "revId": "a749eca264e33195a17db3d9a9d395c7afc9fb6b",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c481b2c3_da58e2e1",
        "filename": "tycho-bundles/org.eclipse.tycho.p2.resolver.impl/src/main/java/org/eclipse/tycho/p2/target/TargetDefinitionResolverService.java",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 171685
      },
      "writtenOn": "2020-12-21T14:27:38Z",
      "side": 1,
      "message": "But resolveFromArguments only throw RTE or do I miss something?\n\nMoving the logging into the resolveFromArguments method it should be possible to rewrite it to\n\n\u003e return resolutionCache.computeIfAbsent(arguments, this::resolveFromArguments)",
      "parentUuid": "11cdb20d_25a606f5",
      "revId": "a749eca264e33195a17db3d9a9d395c7afc9fb6b",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5396ceb7_33763988",
        "filename": "tycho-bundles/org.eclipse.tycho.p2.resolver.impl/src/main/java/org/eclipse/tycho/p2/target/TargetDefinitionResolverService.java",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 101744
      },
      "writtenOn": "2020-12-21T14:32:54Z",
      "side": 1,
      "message": "Correct, but if computeIfAbsent throws, nothing is cached (which works for the calling thread). But then the next worker will try to resolve it again and again.",
      "parentUuid": "c481b2c3_da58e2e1",
      "revId": "a749eca264e33195a17db3d9a9d395c7afc9fb6b",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c5c9ffd1_cac9d084",
        "filename": "tycho-bundles/org.eclipse.tycho.p2.resolver.impl/src/main/java/org/eclipse/tycho/p2/target/TargetDefinitionResolverService.java",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 171685
      },
      "writtenOn": "2020-12-21T14:43:15Z",
      "side": 1,
      "message": "Good point. I wonder if we should only cache TargetDefinitionResolver instances, pass the ResolutionArguments (what then better is called ResoloutionContext) in the constructor and change \n\n\u003e resolveContent()\n\nto a synchronized\n\n\u003e getContent()\n\ngetContent can the work the following way:\n\n- if not resolved, star the resolve process\n- if resolved but failed throw exception\n- if resolved and succeeds return value\n\nWDT?",
      "parentUuid": "5396ceb7_33763988",
      "revId": "a749eca264e33195a17db3d9a9d395c7afc9fb6b",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6e977918_ef01f1fe",
        "filename": "tycho-bundles/org.eclipse.tycho.p2.resolver.impl/src/main/java/org/eclipse/tycho/p2/target/TargetDefinitionResolverService.java",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 101744
      },
      "writtenOn": "2021-01-04T07:25:00Z",
      "side": 1,
      "message": "Hmm, I don\u0027t see an immediate benefit from that. That would split the cache implementation. Currently the only responsibility of TargetDefinitionResolverService is the caching, so it stay there IMHO - while keeping TargetDefinitionResolver stateless.",
      "parentUuid": "c5c9ffd1_cac9d084",
      "revId": "a749eca264e33195a17db3d9a9d395c7afc9fb6b",
      "serverId": "97ee7c02-f12f-4043-b43e-dea463d88b31",
      "unresolved": true
    }
  ]
}